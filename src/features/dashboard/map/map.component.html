<div class="map_container  min-h-dvh">
  <google-map style="position: absolute; top: 0px; bottom: 0; left: 0; right: 0;" height="100%" width="100%"
    [options]="options">
    @for(location of locations(); track location){
    <map-advanced-marker (mapClick)="openInfoWindow(markerElem , location)" #markerElem="mapAdvancedMarker"
      [position]="{ lat: location.latitude, lng: location.longitude }" [title]="location.deviceName"
      [content]="location.content" />
    }
    <map-info-window #infoWindow="mapInfoWindow">
      <div *ngIf="selectedLocation" class="info_window p-4 w-60">
        <div class="flex items-center gap-6 mb-6">
          <div>
            <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M21.25 25.625H8.75C5 25.625 2.5 23.75 2.5 19.375V10.625C2.5 6.25 5 4.375 8.75 4.375H21.25C25 4.375 27.5 6.25 27.5 10.625V19.375C27.5 23.75 25 25.625 21.25 25.625Z"
                stroke="#1A232D" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round"
                stroke-linejoin="round" />
              <path d="M7.5 10V20" stroke="#1A232D" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round"
                stroke-linejoin="round" />
              <path d="M11.25 10V15" stroke="#1A232D" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round"
                stroke-linejoin="round" />
              <path d="M11.25 18.75V20" stroke="#1A232D" stroke-width="1.5" stroke-miterlimit="10"
                stroke-linecap="round" stroke-linejoin="round" />
              <path d="M18.75 10V11.25" stroke="#1A232D" stroke-width="1.5" stroke-miterlimit="10"
                stroke-linecap="round" stroke-linejoin="round" />
              <path d="M15 10V20" stroke="#1A232D" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round"
                stroke-linejoin="round" />
              <path d="M18.75 15V20" stroke="#1A232D" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round"
                stroke-linejoin="round" />
              <path d="M22.5 10V20" stroke="#1A232D" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round"
                stroke-linejoin="round" />
            </svg>
          </div>
          <div>
            <h5 class="text-xl font-medium">{{ 'MAP.BEACON_ID' | translate }}</h5>
            <p class="text-gold_color ">{{selectedLocation?.identifair}}</p>
          </div>
        </div>

        <div class="flex items-center gap-6 mb-6">
          <div>
            <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M4.52512 10.6125C6.98762 -0.212497 23.0251 -0.199996 25.4751 10.625C26.9126 16.975 22.9626 22.35 19.5001 25.675C16.9876 28.1 13.0126 28.1 10.4876 25.675C7.03762 22.35 3.08762 16.9625 4.52512 10.6125Z"
                stroke="#1A232D" stroke-width="1.5" />
              <path
                d="M14.9996 16.7874C17.1535 16.7874 18.8996 15.0414 18.8996 12.8874C18.8996 10.7335 17.1535 8.98742 14.9996 8.98742C12.8457 8.98742 11.0996 10.7335 11.0996 12.8874C11.0996 15.0414 12.8457 16.7874 14.9996 16.7874Z"
                stroke="#1A232D" stroke-width="1.5" />
            </svg>
          </div>
          <div>
            <h5 class="text-xl  font-medium">{{ 'MAP.LOCATION' | translate }}</h5>
            <p class="text-gold_color">{{selectedLocation?.location}}</p>
          </div>
        </div>

        <div class="flex items-center gap-6 mb-6">
          <div>
            <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M27.5 15C27.5 21.9 21.9 27.5 15 27.5C8.1 27.5 2.5 21.9 2.5 15C2.5 8.1 8.1 2.5 15 2.5C21.9 2.5 27.5 8.1 27.5 15Z"
                stroke="#1A232D" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
              <path d="M19.6371 18.975L15.7621 16.6625C15.0871 16.2625 14.5371 15.3 14.5371 14.5125V9.38751"
                stroke="#1A232D" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
          </div>
          <div>
            <h5 class="text-xl font-medium">{{ 'MAP.LAST_UPDATE' | translate }}</h5>
            <p class="text-gold_color">{{selectedLocation?.lastActive}}</p>
          </div>
        </div>

        <div class="flex items-center gap-6 mb-6">
          <div>
            <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M3.0625 18.7125C4.4 23.0125 8.00001 26.325 12.475 27.2375" stroke="#1A232D" stroke-width="2"
                stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round" />
              <path d="M2.5625 13.725C3.2 7.4125 8.52499 2.5 15 2.5C21.475 2.5 26.8 7.425 27.4375 13.725"
                stroke="#1A232D" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round"
                stroke-linejoin="round" />
              <path d="M17.5127 27.25C21.9752 26.3375 25.5627 23.0625 26.9252 18.775" stroke="#1A232D" stroke-width="2"
                stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
          </div>
          <div>
            <h5 class="text-xl font-medium">{{ 'MAP.STATUS' | translate }}</h5>
            <p [class]=" selectedLocation?.isOnline ? 'text-success_color':'text-danger_color' ">
              {{selectedLocation?.isOnline ? ('MAP.ONLINE' | translate) : ('MAP.OFFLINE' | translate) }}</p>
          </div>
        </div>

        <div class="flex items-center gap-6 mb-6">
          @if(selectedLocation?.battery >= 50){
          <div class="flex justify-center  items-center text-success_color">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M17.0833 7.91667C18.3333 7.91667 18.3333 8.33333 18.3333 9.16667V10.8333C18.3333 11.6667 18.3333 12.0833 17.0833 12.0833"
                stroke="#14AB46" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
              <path d="M5.31665 8.33333C5.59165 9.425 5.59165 10.575 5.31665 11.6667" stroke="#14AB46"
                stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
              <path d="M8.2334 8.33333C8.5084 9.425 8.5084 10.575 8.2334 11.6667" stroke="#14AB46" stroke-width="1.5"
                stroke-linecap="round" stroke-linejoin="round" />
              <path
                d="M10.8334 15.8333H5.83341C2.50008 15.8333 1.66675 15 1.66675 11.6667V8.33333C1.66675 5 2.50008 4.16667 5.83341 4.16667H10.8334C14.1667 4.16667 15.0001 5 15.0001 8.33333V11.6667C15.0001 15 14.1667 15.8333 10.8334 15.8333Z"
                stroke="#14AB46" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
          </div>
          }@else if (selectedLocation?.battery < 50 && selectedLocation?.battery>= 20) {
            <div class="flex justify-center  items-center text-warning_color">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M17.0833 7.91666C18.3333 7.91666 18.3333 8.33333 18.3333 9.16666V10.8333C18.3333 11.6667 18.3333 12.0833 17.0833 12.0833"
                  stroke="#FF9500" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                <path d="M5.31665 8.33334C5.59165 9.425 5.59165 10.575 5.31665 11.6667" stroke="#FF9500"
                  stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                <path d="M8.2334 8.33334C8.5084 9.425 8.5084 10.575 8.2334 11.6667" stroke="#FF9500" stroke-width="1.5"
                  stroke-linecap="round" stroke-linejoin="round" />
                <path
                  d="M10.8334 15.8333H5.83341C2.50008 15.8333 1.66675 15 1.66675 11.6667V8.33333C1.66675 5 2.50008 4.16666 5.83341 4.16666H10.8334C14.1667 4.16666 15.0001 5 15.0001 8.33333V11.6667C15.0001 15 14.1667 15.8333 10.8334 15.8333Z"
                  stroke="#FF9500" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
            </div>
            }@else {
            <div class="flex justify-center  text-danger_color">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M17.0833 7.91667C18.3333 7.91667 18.3333 8.33334 18.3333 9.16667V10.8333C18.3333 11.6667 18.3333 12.0833 17.0833 12.0833"
                  stroke="#FF0004" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                <path d="M5.31665 8.33333C5.59165 9.42499 5.59165 10.575 5.31665 11.6667" stroke="#FF0004"
                  stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                <path d="M8.23334 8.33333C8.50834 9.42499 8.50834 10.575 8.23334 11.6667" stroke="#FF0004"
                  stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                <path
                  d="M10.8334 15.8333H5.83335C2.50002 15.8333 1.66669 15 1.66669 11.6667V8.33334C1.66669 5.00001 2.50002 4.16667 5.83335 4.16667H10.8334C14.1667 4.16667 15 5.00001 15 8.33334V11.6667C15 15 14.1667 15.8333 10.8334 15.8333Z"
                  stroke="#FF0004" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
            </div>
            }
            <div>
              <h5 class="text-xl font-medium">{{ 'MAP.BATTERY_STATUS' | translate }}</h5>
              <p
                [ngClass]="{'text-success_color':selectedLocation?.battery >= 50 , 'text-warning_color':selectedLocation?.battery < 50 && selectedLocation?.battery>= 20 , 'text-danger_color': selectedLocation?.battery < 20}">
                {{selectedLocation?.battery +'%' }}</p>
            </div>
        </div>
      </div>
    </map-info-window>
  </google-map>
</div>